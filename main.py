import argparse
import os

from static_analysis_apk import static_analysis

def label_apks(malware_dir, goodware_dir):
    apks = []
    labels = []

    # Label malware APKs as 1
    for apk_file in os.listdir(malware_dir):
        # if apk_file.endswith('.apk'):
        apks.append(os.path.join(malware_dir, apk_file))
        labels.append(1)

    # Label benign APKs as 0
    for apk_file in os.listdir(goodware_dir):
        # if apk_file.endswith('.apk'):
        apks.append(os.path.join(goodware_dir, apk_file))
        labels.append(0)

    return apks, labels


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--malware', type=str, required=True, help='Path to malware directory')
    parser.add_argument('--goodware', type=str, required=True, help='Path to benign directory')
    args = parser.parse_args()

    apks, labels = label_apks(args.malware, args.goodware)
    print('apks:', apks)
    print('Labels:', labels)
    static_analysis(apks, labels)
